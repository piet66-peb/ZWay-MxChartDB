<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta charset="utf-8">
      <title>MxChartDB: Repair</title>
      <link rel="shortcut icon" href="/ZAutomation/api/v1/load/modulemedia/MxChartDB/icon.png">

    <style>
        {
            font-family: Arial, Helvetica, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }
        td, th {
            border: 1px solid #ddd;
            padding: 8px;
        }
        tr:nth-child(even){background-color: #f2f2f2;}
        tr:hover {background-color: #ddd;}
        th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #04AA6D;
            color: white;
        }
         .center {text-align:center;}
    </style>

   </head>
   <body>
      <h1>MxChartDB: Repair</h1>
      <h2>How to repair the error 'wrong Chart id in configuration'</h2>

      All data of a chart are stored into two tables:
      <ul>
          <li>the header data in table &lt;Chart id&gt;</li>
          <li>the value sets in table &lt;Chart id&gt;_header</li>
      </ul>
      with &lt;Chart id&gt; = 'MxChartDB'+Instance number.
      <br>
      At every instance start the correct Chart id is checked.
      <br><br>
      There are two reasons for a wrong Chart id:
      <ol>
          <li>You have copied the definition of an existing chart.</li>
          <li>The instance number was changed by Z-Way.</li>
      </ol>

      <h3>Solution for case 1</h3>
      If you copy the definition of an existing chart, also the Chart id of the
      source is copied.
      <br>
      Reset this by choosing 'start a new chart' in the data control section.

      <h3>Solution for case 2</h3>
      It may happen, that Z-Way changes the id of an instance. 
      <br><br>
      For example if you use
      the function http://&lt;ip&gt;:8083/ZAutomation/api/v1/modules/reinitialize/&lt;module&gt;.
      <br>
      This function has the troublesome feature of renumbering all existing instances of the module.
      <br><br>
      To solve this problem without loosing the stored data you have to rename the chart tables with
      the correct chart id.
      <br><br>
      You can do this in the
      <a href='/ZAutomation/api/v1/load/modulemedia/MxChartDB/HTML/admin.html' 
         target='_blank'>Chart Administration</a> page. 
     There is a special function called 'Correct Chart Id'.

       <br><br>This function
       <ul>
           <li>stops the running chart instance</li>
           <li>copies the chart tables to those with the correct chart id</li>
           <li>corrects the chart index</li>
           <li>enters the new chart id in the instance definition</li>
           <li>deletes the chart tables with the old chart id</li>
           <li>restarts the chart instance</li>
       </ul>
      If several charts are affected, observe the correct order.
      <br>
      Ensure that 'continue the chart' is set in the data control section. 
   </body>
</html>

